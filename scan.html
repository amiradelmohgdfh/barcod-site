<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>اسکن بارکد</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="text-align:center;font-family:tahoma">

  <h2>اسکن بارکد</h2>

  <p>برای اسکن، عکس بگیرید یا تصویر بارکد را انتخاب کنید</p>

  <input
    type="file"
    accept="image/*"
    capture="environment"
    id="fileInput"
  >

  <p id="result" style="margin-top:20px;font-size:18px;"></p>

  <script src="https://unpkg.com/html5-qrcode@2.3.8/minified/html5-qrcode.min.js"></script>

  <script>
    const result = document.getElementById("result");
    const input = document.getElementById("fileInput");

    const html5QrCode = new Html5Qrcode("reader-temp");

    input.addEventListener("change", async (e) => {
      const file = e.target.files[0];
      if (!file) return;

      result.innerText = "در حال پردازش تصویر...";

      try {
        const decodedText = await html5QrCode.scanFile(file, true);
        result.innerText = "بارکد اسکن شد: " + decodedText;
      } catch (err) {
        result.innerText = "❌ بارکد در تصویر شناسایی نشد";
      }
    });
  </script>

</body>
</html>
